"use strict";function getStorgae(e){return JSON.parse(window.localStorage.getItem(e))}function storeLocal(e,t){window.localStorage.setItem(e,t)}function getLocal(e){return window.localStorage.getItem(e)}function showLoading(e){e.show({template:'<ion-spinner icon="spiral"></ion-spinner>'})}function hideLoading(e){e.hide()}function toast(e,t,o,a){e.show(t,o,a).then(function(e){},function(e){})}angular.module("mobix",["ionic","ngResource","ngCordova","ionic-native-transitions","ng-fusioncharts","ui.calendar"]).run(function(e,t,o,a,n,s,r){e.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault(),t.deviceInformation=ionic.Platform.device(),FCMPlugin.getToken(function(e){if(console.log(e),null!==window.localStorage.getItem("auth")){var o=1;"android"!==angular.lowercase(t.deviceInformation.platform)&&(o=2);var a={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,EmpId:t.userauth.EmpId,devicetoken:e,devicetype:o};s.post(a,function(e){},function(e){})}else storeLocal("devicetoken",e)},function(e){console.log(e)}),FCMPlugin.onNotification(function(e){e.wasTapped,r.schedule({id:1,title:"Digital MI",text:e.message,icon:"res://icon.png"}).then(function(e){})},function(e){},function(e){})}),t.$state=o,t.$on("$stateChangeStart",function(e,a,s,r,l){var i=a.name;t.curentState=i;var d=["Login","Forgot"];t.bodyClass=i.replace(".","_"),void 0!==i&&(d.indexOf(i)===-1&&null===window.localStorage.getItem("auth")?o.go("Login"):(null!==window.localStorage.getItem("auth")&&(t.userauth=JSON.parse(atob(getLocal("auth"))),""!==t.userauth.photo?t.userauth.imgUrl=n.profileimg+"/"+t.userauth.CollegeId+"/"+t.userauth.BranchId+"/"+t.userauth.photo:t.userauth.imgUrl="images/profile.jpg"),t.isDashboard="mobix.Dashboard"===i))})}).config(function(e,t,o){o.tabs.position("bottom"),e.state("Login",{url:"/login",templateUrl:"templates/login.html",controller:"LoginController"}).state("mobix",{url:"/mobix",abstract:!0,templateUrl:"templates/menu.html",controller:"AppController"}).state("mobix.Dashboard",{url:"/dashboard",nativeTransitions:{type:"flip",direction:"down"},views:{menuContent:{templateUrl:"templates/dashboard.html",controller:"DashboardController"}}}).state("mobix.ApplyLeave",{url:"/leave/apply",nativeTransitions:{type:"flip",direction:"up"},views:{menuContent:{templateUrl:"templates/apply_leave.html",controller:"LeaveApplyController"}}}).state("mobix.PopMenu",{url:"/popmenu",nativeTransitions:{type:"flip",direction:"up"},views:{menuContent:{templateUrl:"templates/popup_menu.html",controller:"PopMenuController"}}}).state("mobix.Students",{url:"/students",nativeTransitions:{type:"flip",direction:"left"},views:{menuContent:{templateUrl:"templates/students_list.html",controller:"StudentsController"}}}).state("mobix.Leaves",{url:"/leaves",nativeTransitions:{type:"flip",direction:"right"},views:{menuContent:{templateUrl:"templates/leaves_list.html",controller:"LeavesController"}}}).state("mobix.LeaveAvail",{url:"/leaves/avail",nativeTransitions:{type:"flip",direction:"left"},views:{menuContent:{templateUrl:"templates/leaves_avail.html",controller:"LeavesAvailController"}}}).state("mobix.SubjectHandle",{url:"/subjects/handle",nativeTransitions:{type:"flip",direction:"right"},views:{menuContent:{templateUrl:"templates/subjects_handle.html",controller:"SubjectsHandleController"}}}).state("mobix.LeaveApproval",{url:"/leaves/approval",nativeTransitions:{type:"flip",direction:"right"},views:{menuContent:{templateUrl:"templates/leaves_approval.html",controller:"LeavesApprovalController"}}}).state("mobix.LeaveRecommend",{url:"/leaves/recommend",nativeTransitions:{type:"flip",direction:"right"},views:{menuContent:{templateUrl:"templates/leaves_recommend.html",controller:"LeavesRecommendController"}}}).state("mobix.StaffApproval",{url:"/leaves/staffapproval",nativeTransitions:{type:"flip",direction:"up"},views:{menuContent:{templateUrl:"templates/staff_approval.html",controller:"StaffApprovalController"}}}).state("mobix.TimeTable",{url:"/timetable",nativeTransitions:{type:"flip",direction:"up"},views:{menuContent:{templateUrl:"templates/time_table.html",controller:"TimeTableController"}}}).state("mobix.Charts",{url:"/charts",nativeTransitions:{type:"flip",direction:"down"},views:{menuContent:{templateUrl:"templates/charts.html",controller:"ChartsController"}}}).state("mobix.Events",{url:"/events",nativeTransitions:{type:"flip",direction:"up"},views:{menuContent:{templateUrl:"templates/events.html",controller:"EventsController"}}}).state("mobix.BulkSMS",{url:"/sms/send",nativeTransitions:{type:"flip",direction:"down"},views:{menuContent:{templateUrl:"templates/bulk_sms.html",controller:"BulkSMSController"}}}).state("mobix.BulkSMSStaff",{url:"/sms/staff",nativeTransitions:{type:"flip",direction:"down"},views:{menuContent:{templateUrl:"templates/bulk_sms_staff.html",controller:"BulkSMSStaffController"}}}).state("mobix.StudLeave",{url:"/students/leave",nativeTransitions:{type:"flip",direction:"down"},views:{menuContent:{templateUrl:"templates/students_leave.html",controller:"StudentsLeaveController"}}}).state("mobix.StudAbsStaus",{url:"/students/absents",nativeTransitions:{type:"flip",direction:"down"},views:{menuContent:{templateUrl:"templates/students_absents.html",controller:"StudentAbsentCtrl"}}}),t.otherwise(function(e,t){e.get("$state").go("Login",{},{reload:!0})})}).config(function(e){e.interceptors.push("HeaderInjector")}).config(function(e){e.setDefaultOptions({duration:400,slowdownfactor:4,iosdelay:-1,androiddelay:-1,winphonedelay:-1,fixedPixelsTop:0,fixedPixelsBottom:0,triggerTransitionEvent:"$ionicView.afterEnter",backInOppositeDirection:!1})}).factory("HeaderInjector",function(){return{request:function(e){return e.headers["content-type"]="application/x-www-form-urlencoded",e}}}).filter("dateFmt",function(e){return function(t){return null==t?"":e("date")(new Date(t),"dd-MMM-yyyy").toUpperCase()}}),angular.module("mobix").constant("URLCONFIG",{api_url:"http://125.99.253.22/services/attendanceservice.asmx/"}).constant("USERAVATAR",{image64:"http://placehold.it/64x64",image300:"http://placehold.it/300x300"}).constant("NOIMG",{image500:"http://placehold.it/500x450"}).constant("IMGURL",{profileimg:"http://125.99.253.22/Upload/EmpPhotos/",collogo:"http://125.99.253.22/Upload/EmpPhotos/"}),angular.module("mobix").factory("Login",function(e,t){return e(t.api_url+"Login",{},{post:{method:"POST"}})}).factory("LeaveGroup",function(e,t){return e(t.api_url+"GetEmpLeaveGroup",{},{post:{method:"POST"}})}).factory("Incharges",function(e,t){return e(t.api_url+"getInchargeStaffNames",{},{post:{method:"POST"}})}).factory("LeaveTypes",function(e,t){return e(t.api_url+"getleavenames",{},{post:{method:"POST"}})}).factory("LeaveAvail",function(e,t){return e(t.api_url+"getInitialLeaves",{},{post:{method:"POST"}})}).factory("ApplyLeave",function(e,t){return e(t.api_url+"SaveLeaveApply",{},{post:{method:"POST"}})}).factory("GetStudents",function(e,t){return e(t.api_url+"GetStudents",{},{post:{method:"POST"}})}).factory("GetLeaveStatusMaster",function(e,t){return e(t.api_url+"GetLeaveStatusMaster",{},{post:{method:"POST"}})}).factory("Getappliedleave",function(e,t){return e(t.api_url+"Getappliedleave",{},{post:{method:"POST"}})}).factory("GetSubjects",function(e,t){return e(t.api_url+"GetSubjects",{},{post:{method:"POST"}})}).factory("GetClassHandlings",function(e,t){return e(t.api_url+"GetClassHandlings",{},{post:{method:"POST"}})}).factory("GetLeavedetails",function(e,t){return e(t.api_url+"GetLeavedetails",{},{post:{method:"POST"}})}).factory("GetCourses",function(e,t){return e(t.api_url+"GetCourses",{},{post:{method:"POST"}})}).factory("SaveLeaveApproval",function(e,t){return e(t.api_url+"SaveLeaveApproval",{},{post:{method:"POST"}})}).factory("leaveApproval",function(e,t){return e(t.api_url+"leaveApproval",{},{post:{method:"POST"}})}).factory("leaveapprovalrejection",function(e,t){return e(t.api_url+"leaveapprovalrejection",{},{post:{method:"POST"}})}).factory("leaverecommendation",function(e,t){return e(t.api_url+"leaverecommendation",{},{post:{method:"POST"}})}).factory("SaveLeaveRecommend",function(e,t){return e(t.api_url+"SaveLeaveRecommend",{},{post:{method:"POST"}})}).factory("leaverecommendrejection",function(e,t){return e(t.api_url+"leaverecommendrejection",{},{post:{method:"POST"}})}).factory("staffinchargeleaveapproval",function(e,t){return e(t.api_url+"staffinchargeleaveapproval",{},{post:{method:"POST"}})}).factory("savestaffICleave",function(e,t){return e(t.api_url+"savestaffICleave",{},{post:{method:"POST"}})}).factory("savestaffICleaverejection",function(e,t){return e(t.api_url+"savestaffICleaverejection",{},{post:{method:"POST"}})}).factory("getTimeTable",function(e,t){return e(t.api_url+"getTimeTable",{},{post:{method:"POST"}})}).factory("getstudentcountcoursewise",function(e,t){return e(t.api_url+"getstudentcountcoursewise",{},{post:{method:"POST"}})}).factory("GetEvents",function(e,t){return e(t.api_url+"GetEvents",{},{post:{method:"POST"}})}).factory("GetCoursesAdmin",function(e,t){return e(t.api_url+"GetCoursesAdmin",{},{post:{method:"POST"}})}).factory("UpdateDevice",function(e,t){return e(t.api_url+"pushnotifyupdate",{},{post:{method:"POST"}})}).factory("GetSemister",function(e,t){return e(t.api_url+"GetSemister",{},{post:{method:"POST"}})}).factory("GetMessageTemplate",function(e,t){return e(t.api_url+"GetMessageTemplate",{},{post:{method:"POST"}})}).factory("GetSMSTemplate",function(e,t){return e(t.api_url+"GetSMSTemplate",{},{post:{method:"POST"}})}).factory("sendBulkSMSNew",function(e,t){return e(t.api_url+"sendBulkSMSNew",{},{post:{method:"POST"}})}).factory("getStudentsAll",function(e,t){return e(t.api_url+"getStudentsAll",{},{post:{method:"POST"}})}).factory("getEmpData",function(e,t){return e(t.api_url+"getEmpData",{},{post:{method:"POST"}})}).factory("GetDepartments",function(e,t){return e(t.api_url+"GetDepartments",{},{post:{method:"POST"}})}).factory("getJobTitle",function(e,t){return e(t.api_url+"getJobTitle",{},{post:{method:"POST"}})}).factory("getStudentWSec",function(e,t){return e(t.api_url+"getStudentWSec",{},{post:{method:"POST"}})}).factory("Getsections",function(e,t){return e(t.api_url+"Getsections",{},{post:{method:"POST"}})}).factory("SaveStuAttendanceApp",function(e,t){return e(t.api_url+"SaveStuAttendanceApp",{},{post:{method:"POST"}})}).factory("GetEmpCourseSubjects",function(e,t){return e(t.api_url+"GetEmpCourseSubjects",{},{post:{method:"POST"}})}).factory("getstudentattstatus",function(e,t){return e(t.api_url+"getstudentattstatus",{},{post:{method:"POST"}})}),angular.module("mobix").controller("ChartsController",function(e,t,o,a,n,s,r){e.myDataSource={chart:{caption:"Students Count ",subcaption:"",startingangle:"120",showlabels:"0",showlegend:"1",enablemultislicing:"0",slicingdistance:"15",showpercentvalues:"0",showpercentintooltip:"0",plottooltext:"Student Count in $label  : $datavalue",theme:"fint"}},e.myDataSource.data=[];var l={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId};showLoading(a),s.post(l,function(t){hideLoading(a);var o=t.d;o=JSON.parse(o.replace("},]","}]")),e.studentsCount=o.studentcount,angular.forEach(e.studentsCount,function(t){e.myDataSource.data.push({label:t.coursedes,value:t.stucount})})},function(e){hideLoading(a),console.log("Chart Error",e)}),r(function(){var e=angular.element(document.getElementsByClassName(".raphael-group-8-creditgroup"));e.html="",console.log(e)},500)}),angular.module("mobix").controller("LeaveApplyController",function(e,t,o,a,n,s,r,l,i,d,u,c,p,h){null!==window.localStorage.getItem("auth")?(e.userauth=t.userauth,e.data={},e.staffInCg={},e.is_exit_leave=!1,e.data.EmpId=t.userauth.EmpId,e.index=function(){var o={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,EmpId:t.userauth.EmpId};showLoading(a),s.post(o,function(o){hideLoading(a);var n=o.d;n=JSON.parse(n.replace("},]","}]")),e.leaveGroups=n.leavegroup,e.data.group_name=n.leavegroup[0].code,e.data.EmpName=n.leavegroup[0].empname,showLoading(a);var s={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,group_name:e.data.group_name};l.post(s,function(t){hideLoading(a);var o=t.d;o=JSON.parse(o.replace("},]","}]")),e.leaveTypes=o.leavename},function(e){hideLoading(a)})},function(e){hideLoading(a)}),showLoading(a),r.post(o,function(t){hideLoading(a);var o=t.d;o=JSON.parse(o.replace("},]","}]")),e.inchargs=o.inchargestaff},function(e){hideLoading(a)})},e.index(),e.leaveCheck=function(o){if(void 0!==o){var n={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,leavename:o,empid:t.userauth.EmpId,group_name:e.data.group_name};showLoading(a),i.post(n,function(t){hideLoading(a);var o=t.d;o=JSON.parse(o.replace("},]","}")),console.log(o),e.data.leaveAvail=o.leavecount.code},function(e){hideLoading(a)})}},e.is_half_day=function(t){e.data.NoofDays=t===!0?.5:1},e.applyLeave=function(s,r){h.confirm("Are you sure you want to Apply Leave ?","Confirm",["Ok","Cancel"]).then(function(l){var i=l;if(1===parseInt(i)&&(showLoading(a),void 0!==r.leaveAvail&&(parseInt(r.NoofDays)>parseInt(r.leaveAvail)?e.is_exit_leave=!0:e.is_exit_leave=!1),s&&!e.is_exit_leave)){staffParseData=JSON.parse(r.StaffICEmpID);var u={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,EmpId:r.EmpId,group_name:r.group_name,NoofDays:r.NoofDays,leavename:r.LeaveType,StaffICEmpID:staffParseData.EmpID,StaffICName:staffParseData.Name,fromdate:p("date")(new Date(r.fromdate),"MM/dd/yyyy"),todate:p("date")(new Date(r.todate),"MM/dd/yyyy"),EmpName:r.EmpName,LeaveType:r.LeaveType};d.post(u,function(e){hideLoading(a),console.log(e),"Fail"!==e.d?(toast(n,"Leave applied successfully","long","center"),c(function(){o.go("mobix.Dashboard")},1e3)):toast(n,"Leave applied failed","long","center")},function(e){hideLoading(a),toast(n,"Leave applied failed","long","center")})}})}):o.go("Login")}).controller("LeavesController",function(e,t,o,a,n,s,r){null!==window.localStorage.getItem("auth")?(e.leaveDetails=[],r.post({CollegeId:t.userauth.CollegeId},function(t){hideLoading(a);var o=t.d;o=JSON.parse(o.replace("},]","}]")),e.leaveStatus=o.leavestatus},function(e){hideLoading(a),console.log(e)}),e.selectStatus=function(o){showLoading(a);var n={CollegeId:t.userauth.CollegeId,EmpId:t.userauth.EmpId,sts:o};s.post(n,function(t){hideLoading(a);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.leaveapplieddetails?(e.leaveDetails=o.leaveapplieddetails,console.log(e.leaveDetails)):e.leaveDetails=[]},function(e){hideLoading(a),console.log(e)})}):o.go("Login")}).controller("LeavesAvailController",function(e,t,o,a,n,s){if(null!==window.localStorage.getItem("auth")){e.leaveDetails=[],showLoading(a);var r={CollegeId:t.userauth.CollegeId,EmpId:t.userauth.EmpId};s.post(r,function(t){hideLoading(a);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.leaveavailable?e.leaveDetails=o.leaveavailable:e.leaveDetails=[]},function(e){hideLoading(a),console.log(e)})}else o.go("Login")}).controller("LeavesApprovalController",function(e,t,o,a,n,s,r,l,i,d){if(null!==window.localStorage.getItem("auth")){e.leaveDetails=[],showLoading(n);var u={CollegeId:t.userauth.CollegeId,EmpId:t.userauth.EmpId};l.post(u,function(t){hideLoading(n);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.leaveapprovaldetails?e.leaveDetails=o.leaveapprovaldetails:e.leaveDetails=[]},function(e){hideLoading(n),console.log(e)}),e.changeLeaveStatus=function(l){e.choosed.length>0?r.confirm("Are you sure you want to "+l+" ?","Confirm",["Ok","Cancel"]).then(function(r){var u=r;1===parseInt(u)&&(showLoading(n),angular.forEach(e.choosed,function(o){pdata=e.leaveDetails[o];var n={CollegeId:t.userauth.CollegeId,EmpId:pdata.empid,EmpName:pdata.empname,EmpGroup:pdata.empleavegroup,LeaveType:pdata.leavetype,FromDate:a("date")(new Date(pdata.fromdate),"MM/dd/yyyy"),ToDate:a("date")(new Date(pdata.todate),"MM/dd/yyyy"),noofdays:pdata.noofdays};"Approve"===l?i.post(n,function(e){console.log(e),toast(s,"Leave Approved","long","center")},function(e){console.log(e)}):d.post(n,function(e){console.log(e),toast(s,"Leave Rejected","long","center")},function(e){console.log(e)})}),hideLoading(n),o.reload())}):toast(s,"Choose any one leave","long","center")},e.choosed=[],e.chooseCheckbox=function(t,o){if(o===!0)e.choosed.push(t);else{var a=e.choosed.indexOf(t);a>-1&&e.choosed.splice(a,1)}},e.refresh=function(){o.reload()},e.isCheckLable="Check All",e.selectAll=function(t){t===!0?(e.choosed=[],angular.forEach(e.leaveDetails,function(t,o){e.choosed.push(o)}),e.isCheckLable="UnChk All"):(e.choosed=[],e.isCheckLable="Check All"),console.log(e.choosed)}}else o.go("Login")}).controller("LeavesRecommendController",function(e,t,o,a,n,s,r,l,i,d){if(null!==window.localStorage.getItem("auth")){e.leaveDetails=[],showLoading(n);var u={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,EmployeeId:t.userauth.EmpId};l.post(u,function(t){hideLoading(n);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.leaverecommendationdetails?e.leaveDetails=o.leaverecommendationdetails:e.leaveDetails=[]},function(e){hideLoading(n),console.log(e)}),e.changeLeaveStatus=function(l){e.choosed.length>0?r.confirm("Are you sure you want to "+l+" ?","Confirm",["Ok","Cancel"]).then(function(r){var u=r;1===parseInt(u)&&(showLoading(n),angular.forEach(e.choosed,function(o){if(pdata=e.leaveDetails[o],"Recommend"===l){var n={CollegeId:t.userauth.CollegeId,EmpId:pdata.empid,group_name:pdata.empleavegroup,leavetype:pdata.leavetype,fromdate:a("date")(new Date(pdata.fromdate),"MM/dd/yyyy"),todate:a("date")(new Date(pdata.todate),"MM/dd/yyyy"),noofdays:pdata.noofdays};i.post(n,function(e){console.log(e),toast(s,"Leave Recommended","long","center")},function(e){console.log(e)})}else{var n={CollegeId:t.userauth.CollegeId,EmpId:pdata.empid,group_name:pdata.empleavegroup,FromDate:a("date")(new Date(pdata.fromdate),"MM/dd/yyyy"),ToDate:a("date")(new Date(pdata.todate),"MM/dd/yyyy")};d.post(n,function(e){console.log(e),toast(s,"Leave Rejected","long","center")},function(e){console.log(e)})}}),hideLoading(n),o.reload())}):toast(s,"Choose any one leave","long","center")},e.choosed=[],e.chooseCheckbox=function(t,o){if(o===!0)e.choosed.push(t);else{var a=e.choosed.indexOf(t);a>-1&&e.choosed.splice(a,1)}},e.refresh=function(){o.reload()},e.isCheckLable="Check All",e.selectAll=function(t){t===!0?(e.choosed=[],angular.forEach(e.leaveDetails,function(t,o){e.choosed.push(o)}),e.isCheckLable="UnChk All"):(e.choosed=[],e.isCheckLable="Check All"),console.log(e.choosed)}}else o.go("Login")}).controller("StaffApprovalController",function(e,t,o,a,n,s,r,l,i,d){if(null!==window.localStorage.getItem("auth")){e.leaveDetails=[],showLoading(n);var u={CollegeId:t.userauth.CollegeId,ICEmpId:t.userauth.EmpId};l.post(u,function(t){hideLoading(n);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.staffICleaveapproval?e.leaveDetails=o.staffICleaveapproval:e.leaveDetails=[]},function(e){hideLoading(n),console.log(e)}),e.changeLeaveStatus=function(l){e.choosed.length>0?r.confirm("Are you sure you want to "+l+" ?","Confirm",["Ok","Cancel"]).then(function(r){var u=r;1===parseInt(u)&&(showLoading(n),angular.forEach(e.choosed,function(o){if(pdata=e.leaveDetails[o],"Approve"===l){var n={CollegeId:t.userauth.CollegeId,EmpId:pdata.empid,EmpName:pdata.empname,EmpGroup:pdata.empleavegroup,LeaveType:pdata.leavetype,FromDate:a("date")(new Date(pdata.fromdate),"MM/dd/yyyy"),ToDate:a("date")(new Date(pdata.todate),"MM/dd/yyyy"),noofdays:pdata.noofdays,staffInchargeId:pdata.inchargeEmpId,staffInchargeName:pdata.inchargeEmpName};i.post(n,function(e){console.log(e),toast(s,"Leave Approved","long","center")},function(e){console.log(e)})}else{var n={CollegeId:t.userauth.CollegeId,EmpId:pdata.empid,EmpName:pdata.empname,EmpGroup:pdata.empleavegroup,LeaveType:pdata.leavetype,FromDate:a("date")(new Date(pdata.fromdate),"MM/dd/yyyy"),ToDate:a("date")(new Date(pdata.todate),"MM/dd/yyyy"),noofdays:pdata.noofdays,staffICId:pdata.inchargeEmpId};d.post(n,function(e){console.log(e),toast(s,"Leave Rejected","long","center")},function(e){console.log(e)})}}),hideLoading(n),o.reload())}):toast(s,"Choose any one leave","long","center")},e.choosed=[],e.chooseCheckbox=function(t,o){if(o===!0)e.choosed.push(t);else{var a=e.choosed.indexOf(t);a>-1&&e.choosed.splice(a,1)}},e.refresh=function(){o.reload()},e.isCheckLable="Check All",e.selectAll=function(t){t===!0?(e.choosed=[],angular.forEach(e.leaveDetails,function(t,o){e.choosed.push(o)}),e.isCheckLable="UnChk All"):(e.choosed=[],e.isCheckLable="Check All"),console.log(e.choosed)}}else o.go("Login")}).controller("StudentsLeaveController",function(e,t,o,a,n,s,r,l,d,u,c,p,h,g,f){e.is_show_form=!0,e.isCheckAll=!0,e.data={},e.data.attandance=new Date,e.years=[];var m=new Date,v=m.getFullYear();for(i=parseInt(v)-5;i<=parseInt(v);i++)e.years.push(i);showLoading(n),l.post({CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,EmpId:t.userauth.EmpId},function(t){hideLoading(n);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.courses?e.courses=o.courses:e.courses=[]},function(e){hideLoading(n),console.log(responseData)}),showLoading(n),c.post({CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,EmpId:t.userauth.EmpId},function(t){hideLoading(n);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.section?e.section=o.section:e.section=[]},function(e){hideLoading(n),console.log(responseData)}),showLoading(n),d.post({CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId},function(t){hideLoading(n);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.semester?e.semesters=o.semester:e.semesters=[]},function(e){hideLoading(n),console.log(responseData)}),e.getSubject=function(o){void 0!==o&&u.post({CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,EmpId:t.userauth.EmpId,CourseCode:o},function(t){hideLoading(n);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.subjects?e.subjects=o.subjects:e.subjects=[]},function(e){hideLoading(n),console.log(responseData)})},e.findStudent=function(o,r){if(o){showLoading(n),e.formData=r;var l={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,Class:void 0!==r.courseSelect?r.courseSelect:"",cmbyears:r.yearSelect,Semister:void 0!==r.sems?r.sems:"",Section:void 0!==r.section?r.section:"",Name:"",stuID:""};h.post(l,function(o){hideLoading(n);var l=o.d;if(l.indexOf("nodata")===-1){l=l.replace("},]","}").replace("}}","}]}"),l=JSON.parse(l),e.students=l.studentdata,e.students.count=e.students[Object.keys(e.students).length-1],e.students.pop(),e.is_show_form=!1,e.choosed=[],showLoading(n),e.formData=r;var i={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,EmpId:t.userauth.EmpId,CourseCode:void 0!==r.courseSelect?r.courseSelect:"",SubCode:void 0!==r.subject?r.subject:"",DateAtt:a("date")(e.data.attandance,"MM/dd/yyyy"),StatusAtt:void 0!==r.status?r.status:""};console.log(i),f.post(i,function(t){hideLoading(n);var o=t.d;console.log(o),o.indexOf("nodata")===-1?(o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.studentlist?e.attendance=o.studentlist:e.attendance=[]):(e.attendance=[],toast(s,"No students data","long","bottom"))}),angular.forEach(e.students,function(t,o){angular.forEach(e.attendance,function(e){console.log("value:",t,"attend:",e)})})}else e.students=[],toast(s,"No students data","long","bottom")})}},e.isCheckLable="Check All",e.selectAll=function(t){t===!0?(e.choosed=[],angular.forEach(e.students,function(t,o){e.choosed.push(o)}),e.isCheckLable="UnChk All"):(e.choosed=[],e.isCheckLable="Check All"),console.log(e.choosed)},e.chooseCheckbox=function(t,o){if(o===!0)e.choosed.push(t);else{var a=e.choosed.indexOf(t);a>-1&&e.choosed.splice(a,1)}console.log(e.choosed)},e.cancel=function(){e.is_show_form=!0},e.doattandance=function(n){if(void 0!==n){e.Present=[],e.Absent=[],angular.forEach(e.students,function(t,o){e.choosed.indexOf(o)>-1?e.Present.push(t.studentid,t.regno,"Present"):e.Absent.push(t.studentid,t.regno,"Absent")});var r=e.Present.toString()+","+e.Absent.toString();0===r.indexOf(",")&&(r=r.substr(1));var l={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,EmpID:t.userauth.EmpId,SubCode:e.formData.subject,CourseCode:e.formData.courseSelect,Semister:e.formData.sems,Section:void 0!==e.formData.section?e.formData.section:"Null",Year:e.formData.yearSelect,DateAtt:a("date")(n,"MM/dd/yyyy"),StuDetails:r};g.post(l,function(e){"Fail"!==e.d?(toast(s,"Attandance added successfully","long","center"),o.go("mobix.Dashboard")):toast(s,"Attandance added failed","long","center")})}else toast(s,"Choose date","long","center")}}).controller("StudentAbsentCtrl",function(e,t,o,a,n,s,r,l,i,d,u,c,p,h){e.is_show_form=!0,e.isCheckAll=!0,e.data={},e.data.attandance=new Date,showLoading(n),l.post({CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,EmpId:t.userauth.EmpId},function(t){hideLoading(n);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.courses?e.courses=o.courses:e.courses=[]},function(e){hideLoading(n),console.log(responseData)}),e.getSubject=function(o){void 0!==o&&(showLoading(n),d.post({CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,EmpId:t.userauth.EmpId,CourseCode:o},function(t){hideLoading(n);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.subjects?e.subjects=o.subjects:e.subjects=[]},function(e){hideLoading(n),console.log(responseData)}))},e.findStudent=function(o,r){if(o){showLoading(n),e.formData=r;var l={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,EmpId:t.userauth.EmpId,CourseCode:void 0!==r.courseSelect?r.courseSelect:"",SubCode:void 0!==r.subject?r.subject:"",DateAtt:a("date")(r.attandance,"MM/dd/yyyy"),StatusAtt:void 0!==r.status?r.status:""};h.post(l,function(t){hideLoading(n);var o=t.d;o.indexOf("nodata")===-1?(o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.studentlist?(e.students=o.studentlist,e.is_show_form=!1):e.students=[]):(e.students=[],toast(s,"No students data","long","bottom"))})}},e.cancel=function(){e.is_show_form=!0}}),angular.module("mobix").controller("LoginController",function(e,t,o,a,n,s,r){null===window.localStorage.getItem("auth")?(e.data={},e.loginSubmit=function(l,i){l&&(showLoading(a),s.post(i,function(s){if(hideLoading(a),e.edata=JSON.parse(s.d),"nodata"!==e.edata.user){e.edata.user.EmpId=i.UserName,storeLocal("auth",btoa(JSON.stringify(e.edata.user)));var l=1;"android"!==angular.lowercase(t.deviceInformation.platform)&&(l=2);var d={CollegeId:e.edata.user.CollegeId,BranchId:e.edata.user.BranchId,EmpId:e.edata.user.EmpId,devicetoken:getLocal("devicetoken"),devicetype:l};r.post(d,function(e){console.log(e),o.go("mobix.Dashboard")},function(e){o.go("mobix.Dashboard")})}else hideLoading(a),toast(n,"Login Failed","long","center")},function(e){hideLoading(a),toast(n,"Login Failed","long","center")}))}):o.go("mobix.Dashboard")}),angular.module("mobix").controller("AppController",function(e,t,o,a,n,s,r,l,i,d,n,u){null!==window.localStorage.getItem("auth")&&(e.isAuth=!0,t.user=JSON.parse(atob(getLocal("auth")))),e.linkGo=function(e){window.open(e,"_system")},e.stageGo=function(e){null!==e?o.current.name!==e&&o.go(e,{},{reload:!0}):o.go("Login",{},{reload:!0})},e.logout=function(){window.localStorage.removeItem("auth"),o.go("Login",{},{reload:!0}),n(function(){u.views.maxCache(0),location.reload()},200)},e.showLeftSlide=function(){i.toggleLeft()},e.showRightMenu=function(){i.toggleRight()}}).controller("DashboardController",function(e,t,o,a,n,s){e.userDetails=o.user}).controller("PopMenuController",function(e,t,o,a,n,s){e.userDetails=o.user,e.linkGo=function(e){window.open(e,"_system")}}),angular.module("mobix").controller("BulkSMSController",function(e,t,o,a,n,s,r,l,d,u,c){if(null!==window.localStorage.getItem("auth")){e.years=[],e.messageData={},e.isFilterShow=!0,e.isMsgBoxShow=!1;var p=new Date,h=p.getFullYear();for(i=parseInt(h)-5;i<=parseInt(h);i++)e.years.push(i);showLoading(a),s.post({CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId},function(t){hideLoading(a);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.courses?e.courses=o.courses:e.courses=[]},function(e){hideLoading(a),console.log(responseData)}),showLoading(a),r.post({CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId},function(t){hideLoading(a);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.semester?e.semester=o.semester:e.semester=[]},function(e){hideLoading(a),console.log(responseData)}),e.findStudent=function(o,s){if(o){var r={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,cmbyears:s.yearSelect,Semister:void 0!==s.semSelect?s.semSelect:"",Name:void 0!==s.name?s.name:"",stuID:void 0!==s.stuid?s.stuid:"",Class:void 0!==s.courseSelect?s.courseSelect:""};showLoading(a),l.post(r,function(t){hideLoading(a),console.log(t),responseData=t.d,"nodata"!==responseData.studentdata?(e.sudents={},responseData=responseData.replace("},],{","}],").replace('"}}','"}').replace(/(\r\n|\n|\r)/gm,""),responseData=JSON.parse(responseData),e.sudents=responseData.studentdata,e.totalRecords=responseData.stucount,e.isFilterShow=!1):e.sudents=[]},function(e){hideLoading(a),toast(n,"Student List could not be displayed. Choose other filters and Submit","long","center"),console.log("getStudentsAll error",e)})}},e.choosed=[],e.parentno=[],e.chooseCheckbox=function(t,o,a){if(a===!0)e.choosed.push(t),e.parentno.push(o);else{var n=e.choosed.indexOf(t),s=e.parentno.indexOf(o);n>-1&&e.choosed.splice(n,1),n>-1&&e.parentno.splice(s,1)}},e.isCheckLable="CheckAll",e.selectAll=function(t){t===!0?(e.choosed=[],e.parentno=[],angular.forEach(e.sudents,function(t){e.choosed.push(t.contactnumber),e.parentno.push(t.parentsphone)}),e.isCheckLable="UnChkAll"):(e.choosed=[],e.parentno=[],e.isCheckLable="CheckAll")},e.studentflag=[],e.studentcheck=function(t,o){if(o===!0)e.studentflag.push(t);else{var a=e.studentflag.indexOf(t);a>-1&&e.studentflag.splice(a,1)}},e.parentflag=[],e.parentcheck=function(t,o){if(o===!0)e.parentflag.push(t);else{var a=e.parentflag.indexOf(t);a>-1&&e.parentflag.splice(a,1)}},e.showMsgTemplate=function(){e.choosed.length>0?(e.isMsgBoxShow=!0,showLoading(a),d.post({CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId},function(t){hideLoading(a),responseData=t.d,"nodata"!==responseData.messagetemplate?(responseData=responseData.replace("},]","}]"),responseData=JSON.parse(responseData),e.msgTemplates=responseData.messagetemplate):e.msgTemplates=[]},function(e){hideLoading(a),console.log("GetMessageTemplate error",e)})):toast(n,"Select Atleast One Student","long","center")},e.backtoFilter=function(){e.isFilterShow=!0},e.backtoFilter2=function(){e.isMsgBoxShow=!1},e.messageTemplate=function(o){o&&(showLoading(a),u.post({CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,MessageCode:o},function(t){hideLoading(a),responseData=t.d,"nodata"!==responseData.message?(responseData=JSON.parse(responseData),e.messageData.writeMsg=responseData.message[0].msgdetails):e.messageData.writeMsg={}}))},e.sendBulkMessage=function(s,r){if(s){showLoading(a);var l=e.studentflag.getUnique(),i=e.parentflag.getUnique(),d=e.choosed.getUnique(),u=e.parentno.getUnique();if(1==l&&1==i)var p={CollegeId:t.userauth.CollegeId,contactnumbers:d.toString()+","+u.toString(),smskey:"SHLRTechSMS",message:r.writeMsg};else if(1==l)var p={CollegeId:t.userauth.CollegeId,contactnumbers:d.toString(),smskey:"SHLRTechSMS",message:r.writeMsg};else if(1==i)var p={CollegeId:t.userauth.CollegeId,contactnumbers:u.toString(),smskey:"SHLRTechSMS",message:r.writeMsg};c.post(p,function(e){console.log(e),"Success"===e.d&&(hideLoading(a),o.go("mobix.Dashboard"),toast(n,"SMS Sent Successfully","long","center"))},function(e){hideLoading(a),toast(n,"Message could not be sent, Try Again Later. ","long","center"),console.log(e)})}}}else o.go("Login",{},{reload:!0})
}).controller("BulkSMSStaffController",function(e,t,o,a,n,s,r,l,i,d,u,c){null!==window.localStorage.getItem("auth")?(e.messageData={},e.isFilterShow=!0,e.isMsgBoxShow=!1,e.data={},showLoading(a),r.post({CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId},function(t){hideLoading(a);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.dept?e.departments=o.dept:e.departments=[]},function(e){hideLoading(a),console.log(responseData)}),showLoading(a),l.post({CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId},function(t){hideLoading(a);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.courses?e.cources=o.courses:e.cources=[]},function(e){hideLoading(a),console.log(responseData)}),showLoading(a),i.post({CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId},function(t){hideLoading(a);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.jobtitle?e.jobTitles=o.jobtitle:e.jobTitles=[]},function(e){hideLoading(a),console.log(responseData)}),e.findSaffs=function(o,r){if(o){var l={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,jobt:void 0!==r.jobTit?r.jobTit:"",empname:void 0!==r.name?r.name:"",coursecode:void 0!==r.courseSelect?r.courseSelect:"",dept:void 0!==r.deptSel?r.deptSel:""};showLoading(a),s.post(l,function(t){hideLoading(a),responseData=t.d,responseData.indexOf("nodata")===-1?(e.empdatas={},responseData=responseData.replace("},]","}]").replace(/(\r\n|\n|\r)/gm,""),responseData=JSON.parse(responseData),console.log(responseData),e.empdatas=responseData.empdata,e.totalRecords=Object.keys(responseData.empdata).length,e.isFilterShow=!1):e.empdatas=[]},function(e){hideLoading(a),toast(n,"Staff List could not be displayed. Try other filters and Submit","long","center"),console.log("getEmpData error",e)})}},e.choosed=[],e.chooseCheckbox=function(t,o){if(o===!0)e.choosed.push(t);else{var a=e.choosed.indexOf(t);a>-1&&e.choosed.splice(a,1)}},e.isCheckLable="CheckAll",e.selectAll=function(t){t===!0?(e.choosed=[],angular.forEach(e.empdatas,function(t){e.choosed.push(t.contact)}),e.isCheckLable="UnChkAll"):(e.choosed=[],e.isCheckLable="CheckAll"),console.log(e.choosed)},e.showMsgTemplate=function(){e.choosed.length>0?(e.isMsgBoxShow=!0,showLoading(a),d.post({CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId},function(t){hideLoading(a),responseData=t.d,"nodata"!==responseData.messagetemplate?(responseData=responseData.replace("},]","}]"),responseData=JSON.parse(responseData),e.msgTemplates=responseData.messagetemplate):e.msgTemplates=[]},function(e){hideLoading(a),console.log("GetMessageTemplate error",e)})):toast(n,"Select atleast One Student","long","center")},e.backtoFilter=function(){e.isFilterShow=!0},e.messageTemplate=function(o){o&&(showLoading(a),u.post({CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,MessageCode:o},function(t){hideLoading(a),responseData=t.d,"nodata"!==responseData.message?(responseData=JSON.parse(responseData),e.messageData.writeMsg=responseData.message[0].msgdetails):e.messageData.writeMsg={}}))},e.sendBulkMessage=function(s,r){if(s){showLoading(a);var l=e.choosed.getUnique(),i={CollegeId:t.userauth.CollegeId,contactnumbers:l.toString(),smskey:"SHLRTechSMS",message:r.writeMsg};c.post(i,function(e){hideLoading(a),"Success"===e.d&&(o.go("mobix.Dashboard"),toast(n,"Successfully message sent","long","center"))},function(e){console.log(e)})}}):o.go("Login",{},{reload:!0})}),Array.prototype.getUnique=function(){for(var e={},t=[],o=0,a=this.length;o<a;++o)e.hasOwnProperty(this[o])||(t.push(this[o]),e[this[o]]=1);return t},angular.module("mobix").controller("StudentsController",function(e,t,o,a,n,s){if(null!==window.localStorage.getItem("auth")){e.students=[],e.years=[];var r=new Date,l=r.getFullYear();for(i=parseInt(l)-5;i<=parseInt(l);i++)e.years.push(i);e.selectYear=function(o){showLoading(a);var n={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,EmpId:t.userauth.EmpId,Year:o};s.post(n,function(t){hideLoading(a);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.students?e.students=o.students:e.students=[]},function(e){hideLoading(a),console.log(responseData)})}}else o.go("Login",{},{reload:!0})}),angular.module("mobix").controller("SubjectsHandleController",function(e,t,o,a,n,s,r,l){if(null!==window.localStorage.getItem("auth")){var i={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,EmpId:t.userauth.EmpId};e.classHandling=e.subjects=e.cources=[],showLoading(a),r.post(i,function(t){hideLoading(a);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.subjects?e.subjects=o.subjects:e.subjects=[]},function(e){hideLoading(a),console.log(responseData)}),showLoading(a),l.post(i,function(t){hideLoading(a);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.courses?e.cources=o.courses:e.cources=[]},function(e){hideLoading(a),console.log(responseData)}),showLoading(a),s.post(i,function(t){hideLoading(a);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.clases?e.classHandling=o.clases:e.classHandling=[]},function(e){hideLoading(a),console.log(responseData)})}else o.go("Login",{},{reload:!0})}).directive("subShow",function(){return{restrict:"EA",replace:!0,template:"<span> {{subjectName}} </span>",scope:{subject:"@",subjects:"@"},link:function(e,t,o){var a=JSON.parse(e.subjects);if(console.log(a),a)for(var n=0;n<a.length;n++)a[n].code===e.subject&&(e.subjectName=a[n].subject)}}}).directive("courShow",function(){return{restrict:"EA",replace:!0,template:"<span> {{courseName}} </span>",scope:{cource:"@",cources:"@"},link:function(e,t,o){var a=JSON.parse(e.cources);if(a)for(var n=0;n<a.length;n++)a[n].code===e.cource&&(e.courseName=a[n].course)}}}),angular.module("mobix").controller("TimeTableController",function(e,t,o,a,n,s,r,l,d,u){if(null!==window.localStorage.getItem("auth")){e.years=[];var c=new Date,p=c.getFullYear();for(i=parseInt(p)-5;i<=parseInt(p);i++)e.years.push(i);var h={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,EmpId:t.userauth.EmpId};console.log(t.userauth),1===parseInt(t.userauth.RoleId)?(showLoading(n),u.post({CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId},function(t){hideLoading(n);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.courses?e.cources=o.courses:e.cources=[]},function(e){hideLoading(n),console.log(responseData)})):(showLoading(n),d.post(h,function(t){hideLoading(n);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.courses?e.cources=o.courses:e.cources=[]},function(e){hideLoading(n),console.log(responseData)})),e.getTimeTables=function(o,a){if(o){showLoading(n);var s={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,Year:a.yearSelect,CourseId:a.courseSelect};l.post(s,function(t){hideLoading(n);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.TimeTable?(a=o.TimeTable,e.timtables={menu:a.slice(0,9),mon:a.slice(10,18),tue:a.slice(19,27),wed:a.slice(28,36),thu:a.slice(37,45),fri:a.slice(46,54),sat:a.slice(55,63)},e.isShown=!0):(e.timtables=[],e.isShown=!1)},function(e){hideLoading(n),console.log(responseData)})}}}else o.go("Login",{},{reload:!0})}).filter("NoData",function(e){return function(e){return"NoData"==e?"-":e}}).controller("EventsController",function(e,t,o,a,n,s,r,l,d){e.years=[];var u=new Date,c=u.getFullYear();for(i=parseInt(c)-5;i<=parseInt(c);i++)e.years.push(i);e.months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e.getEvents=function(o,a){if(o){var s={CollegeId:t.userauth.CollegeId,BranchId:t.userauth.BranchId,month:a.monthSelect,year:a.yearSelect};d.post(s,function(t){hideLoading(n);var o=t.d;o=JSON.parse(o.replace("},]","}]")),"nodata"!==o.events?(e.events=[],angular.forEach(o.events,function(t){e.events.push({title:t.title,start:new Date(t.startdate),end:new Date(t.enddate),className:["openSesame"]})}),e.isShown=!0,e.uiConfig={calendar:{height:450,editable:!0,header:{left:"title",center:"",right:"today prev,next"},eventRender:e.eventRender}},e.eventSources=[e.events]):(e.events=[],e.isShown=!1)},function(e){hideLoading(n),console.log(responseData)})}}});